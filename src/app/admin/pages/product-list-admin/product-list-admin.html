<div class="container botones">
  <!-- BOT√ìN AGREGAR -->
  <div>
    <button class="btn btn-info mb-3" (click)="openAddModal()">‚ûï Produkt hinzuf√ºgen</button>
  </div>

  <!-- BOT√ìN PEDIDOS -->
  <div>
    <a class="btn btn-info mb-3" routerLink="/pedidos"> üì¶ Bestellungen</a>
  </div>
  <!-- BOT√ìN LOGOUT -->
  <div>
    <button class="btn btn-danger mb-3 ms-3" (click)="logout()">üîí Abmelden</button>
  </div>

  <br />
</div>
<div class="container mt-4">
  <!-- LISTADO DE PRODUCTOS -->

  <div class="row row-cols-1 row-cols-md-3 g-4">
    @for(product of products(); track product.id) {
    <div class="col">
      <div class="card bg-dark text-white shadow border-secondary h-100">
        @if (product?.imagenes?.length) {
        <img
          [src]="'http://localhost:3000' + product.imagenes[0]?.imageUrl"
          class="card-img-top"
          style="height: 180px; object-fit: cover"
        />
        }

        <div class="card-body d-flex flex-column">
          <h5 class="text-info">{{ product.name }}</h5>
          <p class="text-warning small">Lagerbestand: {{ product.stock }}</p>
          <p class="text-warning small">ID: {{ product.id }}</p>
          <p class="small">{{ product.description }}</p>
          <p class="fw-bold text-success mt-auto">‚Ç¨ {{ product.price }}</p>

          <div class="gap-2 d-flex mt-3">
            <button class="btn btn-warning btn-sm w-50" (click)="openEditModal(product)">
              Bearbeiten
            </button>
            <button class="btn btn-danger btn-sm w-50" (click)="deleteProduct(product.id)">
              L√∂schen
            </button>
          </div>
        </div>
      </div>
    </div>
    }
  </div>
</div>

<!-- MODAL FORMULARIO -->
 @if (showModal()) {
<div class="modal fade show" tabindex="-1" style="display: block" >
  <div class="modal-dialog">
    <div class="modal-content bg-dark text-white">
      <div class="modal-header">
        <h5 class="modal-title text-info">
          {{ editMode() ? '‚úèÔ∏è Produkt bearbeiten' : 'üÜï Neues Produkt hinzuf√ºgen' }}
        </h5>
        <button type="button" class="btn-close btn-close-white" (click)="closeModal()"></button>
      </div>

      <div class="modal-body">
        <form [formGroup]="productoForm" (ngSubmit)="submitForm()" class="card p-4 shadow">
          <h3 class="mb-3">Crear Producto</h3>

          <div class="mb-3">
            <label class="form-label">Name</label>
            <input formControlName="name" class="form-control" placeholder="Nombre del producto" />
          </div>

          <div class="mb-3">
            <label class="form-label">Description</label>
            <textarea formControlName="description" class="form-control"></textarea>
          </div>

          <div class="mb-3">
            <label class="form-label">Price</label>
            <input type="number" formControlName="price" class="form-control" />
          </div>

          <div class="mb-3">
            <label class="form-label">Lagerbestand</label>
            <input type="number" formControlName="stock" class="form-control" />
          </div>

          <div class="mb-3">
            <label class="form-label">Im√°genes</label>
            <input type="file" multiple class="form-control" (change)="onFileChange($event)" />
          </div>

          <!-- ‚úÖ Previsualizaci√≥n de im√°genes -->
          @if (imagenesPreview().length > 0) {
          <div class="row mt-3">
            @for (img of imagenesPreview(); track $index) {
            <div class="col-3">
              <img
                [src]="img"
                class="img-thumbnail mb-2"
                style="height: 100px; object-fit: cover"
              />
            </div>
            }
          </div>
          }

          <button class="btn btn-primary w-100 mt-3" [disabled]="productoForm.invalid">
            Crear Producto
          </button>
        </form>
      </div>

      <div class="modal-footer">
        <button class="btn btn-secondary" (click)="closeModal()">Abbrechen</button>
      </div>
    </div>
  </div>
</div>
 }

